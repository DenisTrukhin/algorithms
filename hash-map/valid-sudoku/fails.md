1. Забыл, что нужно обрабатывать только заполненные клетки
2. Неправильно обработал пропуск пустых клеток
3. Синтаксические ошибки
4. Решил не оптимально, с лишними циклами