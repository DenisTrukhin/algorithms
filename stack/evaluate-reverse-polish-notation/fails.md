1. Забыл про приколы целочисленного деления отрицательных чисел