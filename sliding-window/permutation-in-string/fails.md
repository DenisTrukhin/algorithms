1. Главная ошибка - браться за решение в 1 час ночи
2. Забыл инкрементировать индекс